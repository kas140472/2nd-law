<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="sins/MOMstyle.css" />
    <script src='sins/jquery.min.js'></script>
    <script src='sins/jquery-ui.min.js'></script>
    <script type="text/javascript" >

         var t1 =0;
        var t2 =0;
        var tf =0;
        var s1 =0;
        var s2 =0;
        var Suniv =0;
        var flag=true;
        var step=0;
        var T1 =0;
        var T2 =0;
        var r1 =false;
        var r2 =false;
        var r3 =false;
        var r4 =false;
        var r5 =false;
        var r6 =false;
        var c1 =0;
        var c2 =0;

        // balls start here

        var k=1;
        var ball=[];
        var ballCount=20;
        var dx=2;
        var dy=-2;
        for(var i=0;i<ballCount;i++){
            ball[i]={x:0,y:0,dx:2,dy:-2,color:"rgba("+Math.ceil(Math.random()*256)+","+Math.ceil(Math.random()*256)+","+Math.ceil(Math.random()*256)+","+Math.ceil(Math.random()*256)+")"}
        }
        var ballRadius=20;
        var canvas;
        var ctx;
        var x;
        var y;

        function start() {

             window.requestAnimFrame = (function(){
                return window.requestAnimationFrame     ||
                    window.webkitRequestAnimationFrame  ||
                    window.mozRequestAnimationFrame     ||
                    window.oRequestAnimationFrame       ||
                    window.msRequestAnimationFrame      ||
                    function( callback ) {
                        window.setTimeout(callback, 1000 / 60);
                    };
            })();

            canvas=document.getElementById("simscreen");
            ctx=canvas.getContext("2d");
            ctx.canvas.width=550;
            ctx.canvas.height=400;
            x=canvas.height-20;
            y=canvas.width/2;

            crankCaseColor = '#9EA18C',
                pistonColor = '#87CEEB',
                //test='#f4eeff',
                left_wall_x=100,
                left_wall_y_start=70,
                left_wall_y_end=220,
                right_wall_x=450,
                right_wall_y_start=70,
                right_wall_y_end=220,



                cylinder = {
                    draw : function () {

                        ctx.strokeStyle = crankCaseColor;
                        ctx.fillStyle = crankCaseColor;
                        ctx.lineWidth = 10;

                        // left cylinder wall

                        ctx.beginPath();
                        ctx.moveTo(left_wall_x,left_wall_y_start);
                        ctx.lineTo(left_wall_x,left_wall_y_end);
                        ctx.stroke();

                        // right cylinder wall

                        ctx.beginPath();
                        ctx.moveTo(right_wall_x,right_wall_y_start);
                        ctx.lineTo(right_wall_x,right_wall_y_end);
                        ctx.stroke();

                        // bottom cylinder wall

                        ctx.beginPath();
                        ctx.moveTo(left_wall_x,left_wall_y_end);
                        ctx.lineTo(right_wall_x,right_wall_y_end);
                        ctx.stroke();

                        // top cylinder wall

                        ctx.beginPath();
                        ctx.moveTo(left_wall_x,left_wall_y_start);
                        ctx.lineTo(right_wall_x,right_wall_y_start);
                        ctx.stroke();


                        // connecting rod - middle-vertical

                        ctx.beginPath();
                        ctx.strokeStyle = pistonColor;
                        ctx.fillStyle = pistonColor;
                        ctx.lineWidth = 10;
                        ctx.moveTo((right_wall_x + left_wall_x)/2,left_wall_y_start);
                        ctx.lineTo((right_wall_x + left_wall_x)/2,left_wall_y_end);
                        ctx.stroke();

                        

                        if(flag === false){

                            T1=t1+273;
                            T2=t2+273;

        




                            if(document.getElementById("radio1").checked==true){
                                r1=true;
                            }
                            else{
                                r1=false;
                            }
                            if(document.getElementById("radio2").checked==true){
                                r2=true;
                            }
                            else{
                                r2=false;
                            }
                            if(document.getElementById("radio3").checked==true){
                                r3=true;
                            }
                            else{
                                r3=false;
                            }
                            if(document.getElementById("radio4").checked==true){
                                r4=true;
                            }
                            else{
                                r4=false;
                            }
                            if(document.getElementById("radio5").checked==true){
                                r5=true;
                            }
                            else{
                                r5=false;
                            }
                            if(document.getElementById("radio6").checked==true){
                                r6=true;
                            }
                            else{
                                r6=false;
                            }



                            if(r1==true)
                            {
                                if(t1==200)
                                {
                                    c1=3.32;
                                }
                                else
                                {
                                    c1=3.29
                                }
                            }


                            if(r2==true)
                            {
                                if(t1==200)
                                {
                                    c1=0.7386;
                                }
                                else
                                {
                                    c1=0.7404;
                                }
                            }

                            if(r3==true)
                            {
                                if(t1==200)
                                {
                                    c1=2.312;
                                }
                                else
                                {
                                    c1=2.351;
                                }
                            }

                            if(r4==true)
                            {
                                if(t1==200)
                                {
                                    c2=3.32;
                                }
                                else
                                {
                                    c2=3.29;
                                }
                            }

                            if(r5==true)
                            {
                                if(t1==200)
                                {
                                    c2=0.7386;
                                }
                                else
                                {
                                    c2=0.7404;
                                }
                            }

                            if(r6==true)
                            {
                                if(t1==200)
                                {
                                    c2=2.312;
                                }
                                else
                                {
                                    c2=2.351;
                                }
                            }



                            tf=(((c1 * T1)+(c2 * T2))/(c1+c2))-273;




                            if(document.getElementById("radio1").checked==true && t1==200)
                            {s1=3.32 * Math.log((tf+273)/(t1+273));}
                            if(document.getElementById("radio1").checked==true && t1==210)
                            {s1=3.29 * Math.log((tf+273)/(t1+273));}

                            if(document.getElementById("radio2").checked==true && t1==200)
                            {s1=0.7386 * Math.log((tf+273)/(t1+273));}
                            if(document.getElementById("radio2").checked==true && t1==210)
                            {s1=0.7404 * Math.log((tf+273)/(t1+273));}

                            if(document.getElementById("radio3").checked==true && t1==200)
                            {s1=2.312 * Math.log((tf+273)/(t1+273));}
                            if(document.getElementById("radio3").checked==true && t1==210)
                            {s1=2.351 * Math.log((tf+273)/(t1+273));}

                            if(document.getElementById("radio4").checked==true && t2==200)
                            {s2=3.32 * Math.log((tf+273)/(t1+273));}
                            if(document.getElementById("radio4").checked==true && t2==210)
                            {s2=3.29 * Math.log((tf+273)/(t1+273));}

                            if(document.getElementById("radio5").checked==true && t2==200)
                            {s2=0.7386 * Math.log((tf+273)/(t1+273));}
                            if(document.getElementById("radio5").checked==true && t2==210)
                            {s2=0.7404 * Math.log((tf+273)/(t1+273));}

                            if(document.getElementById("radio6").checked==true && t2==200)
                            {s2=2.312 * Math.log((tf+273)/(t1+273));}
                            if(document.getElementById("radio6").checked==true && t2==210)
                            {s2=2.351 * Math.log((tf+273)/(t1+273));}

                            Suniv=s1+s2;

                            document.getElementById("p1").innerHTML="Initial temp of system1 (T1) : "+t1+" °C";
                            document.getElementById("p2").innerHTML="Initial temp of system2 (T2) : "+t2+" °C";
                            document.getElementById("p3").innerHTML="Final temp of mixed fluid : "+tf.toFixed(2)+" °C";
                            document.getElementById("p4").innerHTML="▲S1 : "+s1.toFixed(5)+" kJ/kgK";
                            document.getElementById("p5").innerHTML="▲S2 : "+s2.toFixed(5)+" kJ/kgK";
                            document.getElementById("p6").innerHTML="▲Suniverse : "+Suniv.toFixed(5)+" kJ/kgK";}

                       
                        else{
                            step=0;
                        }
                    }

                     (function animloop(){
                requestAnimFrame(animloop);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                cylinder.draw();
            })();

                };

        function draw(){
            ctx.clearRect(0,0,canvas.width,canvas.height)
            for(var i=0;i<ballCount;i++){

                if(k===1){

                    ball[i].x=Math.random()*canvas.width-ballRadius;
                    ball[i].y=Math.random()*canvas.height-ballRadius;

                }
                ctx.beginPath();
                ctx.arc(ball[i].x,ball[i].y,ballRadius,0,Math.PI*2);
                ctx.fillStyle=ball[i].color;
                ctx.fill();
                ctx.closePath();

            }
            move();
            rebound();
        }

        function move(){

            for(var i=0;i<ballCount;i++){
                ball[i].x=ball[i].x+ball[i].dx;
                ball[i].y=ball[i].y+ball[i].dy;
                k=0;
            }

        }

        function rebound(){
            for(var i=0;i<ballCount;i++){
                if(ball[i].x+ball[i].dx>canvas.width-ballRadius||ball[i].x+ball[i].dx<ballRadius)
                {
                    ball[i].dx=-ball[i].dx+Math.random();
                }
                if(ball[i].y+ball[i].dy>canvas.height-ballRadius||ball[i].y+ball[i].dy<ballRadius)
                {
                    ball[i].dy=-ball[i].dy+Math.random()+0.2;
                }
            }
        }

        setInterval(draw,100);
        draw();

        // balls end here


        function simstate() {

            if (flag===true){
                document.getElementById('playpausebutton').src="sins/bluepausedull.png";
                flag=false;

                $('#l1spinner').spinner("disable");
                $('#l2spinner').spinner("disable");
                

                $('#l1slider').slider("disable");
                $('#l2slider').slider("disable");
                

                document.getElementById("radio1").disabled=true;
                document.getElementById("radio2").disabled=true;
                document.getElementById("radio3").disabled=true;
                document.getElementById("radio4").disabled=true;
                document.getElementById("radio5").disabled=true;
                document.getElementById("radio6").disabled=true;

                

            }

            else {
                document.getElementById('playpausebutton').src="sins/blueplaydull.png";
                flag=true;

                $('#l1spinner').spinner("enable");
                $('#l2spinner').spinner("enable");
                

                $('#l1slider').slider("enable");
                $('#l2slider').slider("enable");
                

                document.getElementById("radio1").disabled=false;
                document.getElementById("radio2").disabled=false;
                document.getElementById("radio3").disabled=false;
                document.getElementById("radio4").disabled=false;
                document.getElementById("radio5").disabled=false;
                document.getElementById("radio6").disabled=false;

            }
        }


        function tf_val(){

            document.getElementById("p3").innerHTML="Final temp of mixed fluid : "+0+" °C";
        }

        function t1_val(input){

            t1=input;
            document.getElementById("p1").innerHTML="Initial temp of system1 (T1) : "+0+" °C";

        }

        function t2_val(input){

            t2=input;
            document.getElementById("p2").innerHTML="Initial temp of system2 (T2) : "+0+" °C";

        }

        function s1_val(){
           
            document.getElementById("p4").innerHTML="Entropy change in system1 : "+0+" kJ/kgK";

        }
        function s2_val(){
            
            document.getElementById("p5").innerHTML="Entropy change in system2 : "+0+" kJ/kgK";

        }

        function Suniv_val(){

            
            document.getElementById("p6").innerHTML="Entropy change of universe : "+0+" kJ/kgK";

        }



        function varinit()
        {

            varchange();

            //Variable r1 slider and number input types

            $('#l1slider').slider("value", 200);
            $('#l1spinner').spinner("value", 200);
            $('#l2slider').slider("value", 200);
            $('#l2spinner').spinner("value", 200);
           
            t1_val(200);
            t2_val(200);
            tf_val();
            s1_val();
            s2_val();
            Suniv_val();

        }

        function varchange()
        {

            // Variable r1 slider and number input types

            $('#l1slider').slider({ max : 210, min : 200, step : 5 });          // slider initialisation : jQuery widget
            $('#l1spinner').spinner({ max : 210, min : 200, step : 5 });            // number initialisation : jQuery widget
            $('#l2slider').slider({ max : 210, min : 200, step : 5 });          // slider initialisation : jQuery widget
            $('#l2spinner').spinner({ max : 210, min : 200, step : 5 });            // number initialisation : jQuery widget

           
            $( "#l1slider" ).on(  "slide",  function( e, ui ) {
                $('#l1spinner').spinner("value",ui.value);
                t1_val(ui.value);
                tf_val();
                s1_val();
                s2_val();
                Suniv_val();
            });

            $( "#l1spinner" ).on( "spin",   function( e, ui ) {
                $('#l1slider').slider("value",ui.value);
                t1_val(ui.value);
                tf_val();
                s1_val();
                s2_val();
                Suniv_val();
            });

            $( "#l1spinner" ).on( "change", function() {
                varchange() } );

            // force

            $( "#l2slider" ).on(  "slide",  function( e, ui ) {
                $('#l2spinner').spinner("value",ui.value);
                t2_val(ui.value);
                tf_val();
                s1_val();
                s2_val();
                Suniv_val();
            });

            $( "#l2spinner" ).on( "spin",   function( e, ui ) {
                $('#l2slider').slider("value",ui.value);
                t2_val(ui.value);
                tf_val();
                s1_val();
                s2_val();
                Suniv_val();
            });

            $( "#l2spinner" ).on( "change", function() {
                varchange() } );

           
            t1_val($('#l1spinner').spinner("value"));
            t2_val($('#l2spinner').spinner("value"));
            tf_val();
            s2_val(); //$('#l3spinner').spinner("value")
            s1_val();
            Suniv_val();

            varupdate();
        }

        function varupdate()
        {

            $('#l1slider').slider("value", $('#l1spinner').spinner('value'));  //updating slider location with change in spinner(debug)
            $('#l2slider').slider("value", $('#l2spinner').spinner('value'));  //updating slider location with change in spinner(debug)

        }

        function check1() {
            document.getElementById("radio1").checked = true;
            document.getElementById("radio2").checked = false;
            document.getElementById("radio3").checked = false;
        }
        function check2() {
            document.getElementById("radio1").checked = false;
            document.getElementById("radio2").checked = true;
            document.getElementById("radio3").checked = false;
        }
        function check3() {
            document.getElementById("radio1").checked = false;
            document.getElementById("radio2").checked = false;
            document.getElementById("radio3").checked = true;
        }
        function check4() {
            document.getElementById("radio4").checked = true;
            document.getElementById("radio5").checked = false;
            document.getElementById("radio6").checked = false;
        }
        function check5() {
            document.getElementById("radio4").checked = false;
            document.getElementById("radio5").checked = true;
            document.getElementById("radio6").checked = false;
        }
        function check6() {
            document.getElementById("radio4").checked = false;
            document.getElementById("radio5").checked = false;
            document.getElementById("radio6").checked = true;
        }


    </script>
</head>

<body onload="varinit();start();">
<!-- Defining Container for Simulation -->
<noscript>
    The simulation requires JavaScript to be enabled.
</noscript>
<div id="container">
    <!-- Replace TITLE with simulation title to be displayed next to logo-->
    <div id="simtitle">Principle of increase of entropy</div>
    <!-- Region for simulation display -->
    <canvas id="simscreen" height="400px" width="550px"></canvas>
    <div id="titleincanvas"></div>
    <!-- Region for comment / question prompts -->
    <div id="commentboxleft">
        <p id="p1" style="line-height:0.4"></p>
        <p id="p2" style="line-height:0.4"></p>
        <p id="p3" style="line-height:0.4"></p>
    </div>
    <div id="commentboxright">
        <p id="p4" style="line-height:0.4"></p>
        <p id="p5" style="line-height:0.4"></p>
        <p id="p6" style="line-height:0.4"></p>
    </div>

    <!-- DND-Title of region for variables display -->
    <div id="vartitle">VARIABLES</div>

    <!-- Region for Input parameters of simulation -->
    <div id="variables">
        <div class="variable">
            <br><br><br><br><br><div class="varname"><p title="Link Length" style="font-size:65%;">Temperature, T1 (°C)</p>
                <br>
                <input id="l1spinner"></div>
            <br>
            <div id="l1slider"></div>
            <br>
            <div class="varname"><p title="Link Length" style="font-size:65%;">Temperature, T2 (°C)</p>
                <br>
                <input id="l2spinner"></div>
            <br>
            <div id="l2slider"></div>
        </div>
    </div>

    <!-- DND-Title of region for controls display -->
    <div id="ctrltitle">CONTROLS</div>
    <!-- Region for User controls of simulation -->
    <div id="controls">
        <img id="playpausebutton" onclick="simstate();" src="sins/blueplaydull.png" />
        <img id="rotationbutton" onclick="location.reload();" src="sins/bluecwdull.png" />
    </div>
    <!-- DND-Copyright display-->
    <div id="copyright" title="Developer : SOLVEr"> Copyright &copy; SOLVE The Virtual Lab @ NITK Surathkal </div>

    <div id="controls2" align="left">
    <span style="font-size:55%"><b>Fluid1</b></span><br>
    <span style="font-size:45%">Water</span><input type="radio" id="radio1"  name="chart1" onclick="check1();"><br>
    <span style="font-size:45%">Air</span><input type="radio" id="radio2"  name="chart1" onclick="check2();"><br>
    <span style="font-size:45%">Butane</span><input type="radio" id="radio3"  name="chart1" onclick="check3();"><br>

    </div>

    <div id="controls3" align="left">
    <span style="font-size:55%"><b>Fluid2</b></span><br>
    <span style="font-size:45%">Water</span><input type="radio" id="radio4"  name="chart2" onclick="check4();"><br>
    <span style="font-size:45%">Air</span><input type="radio" id="radio5"  name="chart2" onclick="check5();"><br>
    <span style="font-size:45%">Butane</span><input type="radio" id="radio6"  name="chart2" onclick="check6();"><br>

    </div>

</div><!-- Container div close -->
</body>
</html>